<!DOCTYPE html>
<html>
<head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4W9HVBX2LB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-4W9HVBX2LB',{ 'debug_mode': true });
</script>

<title>FundraiseUp</title>
</head>
<body>

<h1>FundraiseUp Test Assignment</h1>

<!-- Fundraise Up: the new standard for online giving -->
<script>(function(w,d,s,n,a)
{if(!w[n])
{var l='call,catch,on,once,set,then,track'
.split(','),i,o=function(n){return'function'==typeof n?o.l.push([arguments])&&o
:function(){return o.l.push([n,arguments])&&o}},t=d.getElementsByTagName(s)[0],
j=d.createElement(s);j.async=!0;j.src='https://cdn.fundraiseup.com/widget/'+a;
t.parentNode.insertBefore(j,t);o.s=Date.now();o.v=4;o.h=w.location.href;o.l=[];
for(i=0;i<7;i++)o[l[i]]=o(l[i]);w[n]=o}
})(window,document,'script','FundraiseUp','AEMZUDUM');</script>
<!-- End Fundraise Up -->

<a href="#XJKDHSTQ" style="display: none" id="donation-button"></a>
	
<script>
    // Function to send event to Google Analytics
    function sendGAEvent(eventName, eventParams) {
        console.log('Attempting to send GA event:', eventName, eventParams);
        if (typeof gtag === 'function') {
            gtag('event', eventName, eventParams);
            console.log('GA event sent successfully:', eventName);
        } else {
            console.error('gtag function not available');
        }
    }

    let checkoutStarted = false;

    // Function to handle donation button click
    function handleDonationButtonClick(event) {
        if (!checkoutStarted) {
            console.log('Donation button clicked');
            checkoutStarted = true;
            sendGAEvent('checkout_started', {
                'event_category': 'Donation',
                'event_label': 'Checkout Started'
            });
        }
    }

    // Function to set up click listener
    function setupClickListener() {
        // Find all elements with href="#XJKDHSTQ"
        const donationTriggers = document.querySelectorAll('a[href="#XJKDHSTQ"]');
        
        if (donationTriggers.length > 0) {
            console.log('Donation triggers found:', donationTriggers.length);
            donationTriggers.forEach(trigger => {
                trigger.addEventListener('click', handleDonationButtonClick);
            });
        } else {
            console.log('No donation triggers found. Will try again in 1 second.');
            setTimeout(setupClickListener, 1000);
        }
    }

    // Set up the listener when the page is loaded
    window.addEventListener('load', function() {
        console.log('Page loaded, setting up click listeners');
        setupClickListener();

        // Send a test event to ensure GA is working
        sendGAEvent('page_view', {
            'event_category': 'Test',
            'event_label': 'Page Loaded'
        });
    });

    // Fallback: listen for clicks on the entire document
    document.addEventListener('click', function(event) {
        const clickedElement = event.target.closest('a[href="#XJKDHSTQ"]');
        if (clickedElement) {
            handleDonationButtonClick(event);
        }
    });
    </script>

</body>
</html>
